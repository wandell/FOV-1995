# Wavelength Encoding {#sec-wavelength-encoding}

Sir Isaac Newton’s sketch in Figure 4.1 summarizes his investigations into the properties of light. In these experiments, Newton separated daylight into its fundamental components by passing it through a prism and creating a rainbow. Newton’s demonstration that light can be decomposed into rays of different wavelength is at the foundation of our understanding of light and color.

To perform these experiments, Newton placed a shutter containing a small hole in the window in his room at Cambridge. The light emerging from the hole in the window shutter served as a point source to illuminate his apparatus. The key elements of the apparatus are featured prominently in the center of the figure: the lens and prism. Newton’s drawing shows that when the daylight passed through the prism, it formed an image of a rainbow on his wall. With two experimental manipulations, he showed that the components of the rainbow were fundamental constituents of light. In the upper left of the sketch, we see a series of holes that Newton drilled in the wall permitting part of the rainbow to continue through to a second prism. This ray of light was cast upon a second surface, but the new image did not produce a second rainbow; rather, as Newton wrote:

> *“the color of the light was never changed in the least. If any part of the red light was refracted, it remained totally of the same red color as before. No orange, no yellow, no green or blue, nor other new color was produced by that refraction.” (Newton, Opticks)*

![Newton’s summary drawing of his experiments with light. Using a point source of light and a prism, Newton separated sunlight into its fundamental components. By reconverging the rays, he also showed that the decomposition is reversible.](/wp-content/uploads/2012/02/newton.png ){#fig-newton width="60%" .aligncenter}

From this experiment, Newton concluded that the pass through the first prism had separated the daylight into its fundamental components. No further change was observed when the ray passed through a second prism.

At the bottom of the sketch Newton illustrated that the decomposition is reversible: passing light through the prism does not destroy the character of the light. To show this Newton converged the rays following their passage through the prism to form a new image; he found that the color of the image same is the same as that of the source. Newton concluded that:

> *“Light being transmitted through the parallel surfaces of two prisms … if it suffered any change by the refraction by one surface, it lost that impression by the contrary refraction of the other surface.”(Newton, Opticks)*

From the second experiment, he concluded that passage through the prism had not destroyed, but merely revealed, the character of the light.

We now know that Newton succeeded in decomposing the sunlight into its *spectral* components, each with its own characteristic wavelength. The prism separates the rays because the prism bends each wavelength of light by a different amount. (See the section on Snell’s law in [Chapter 3](/chapter-3-the-photoreceptor-mosaic/)). When we see the spectral components separately, they each have a different color appearance. Light with relatively long wavelengths appears red when viewed against a dark background. Light with relatively short wavelengths appears blue when viewed against a dark background. Shorter wavelengths of light are refracted more strongly than longer wavelengths. A spectral light, with energy only at a single wavelength, is also called a *monochromatic light*.

![A spectroradiometer is used to measure the spectral power distribution of light. (a) A schematic design of a spectroradiometer includes a means for separating the input light into its different wavelengths and a detector for measuring the energy at each of the separate wavelengths. (b) The color names associated with the appearance of lights at a variety of wavelengths are shown (After Wyszecki and Stiles, 1982).](/wp-content/uploads/2012/02/spectroradiometer.png){#fig-spectroradiometer width="60%" .align-right}

Newton’s apparatus suggests a simple device we might build to measure the amount of power a light has in each of the different wavelength bands. As illustrated on the top of Figure 4.2, by proper use of lenses and prisms, we can form a focused image of the spectral components in an image plane with a movable slit placed in front of a photodetecting sensor. To measure the energy at different wavelengths, we move the slit passing only some of the spectral components at each position, and thus we measure the energy of the source at different wavelengths of light. In the visible region, the wavelength of light is on the order of a few hundred billionths of a meter, or *nanometers* (nm).

The *spectral power distribution* of a light is the function that defines the power (watts = Joules/sec) in the light in each wavelength band. In the modern theory of physics, the wavelength of light can be thought of in two different ways. We describe the light as if it were a continuous wave as it passes through a medium. When the light exchanges energy with some material, say by giving up its energy to be absorbed, we describe the light as if it were a discrete object called a *photon* or *quantum* of light. The amount of energy given up by the photon is predicted by the wavelength of the light.

![Principle of Superposition. The measurement of light spectral power distributions satisfies the principle of superposition. The spectral power distributions of two lights measured separately are shown in (a) and (b) and together in (c). The spectral power distribution of the mixture is the sum of the individual measurements, thus demonstrating that superposition holds true.](/wp-content/uploads/2012/02/ill.superposition-990x1024.png){#fig-superposition width="60%" .align-right}

The experimental aspect of light measurement that makes it useful and predictable is that the measurement satisfies the principle of superposition. We can demonstrate the superposition of light measurement as follows. First, measure the spectral power distributions of two lights separately. Then, mix the two lights together and measure again. The spectral power distribution of the mixture will be the sum of the first two spectral power distributions. This property of light mixture is illustrated in Figure~??. Superposition is a crucial property of light measurement because it implies that we can measure the energy of a light at each wavelength separately, and then combine the individual measurements to predict spectral power distribution when the spectral components are mixed together.

Suppose we wish to measure the spectral power distribution of a light source. How many wavelengths should we measure? Or, equivalently, how finely do we have to sample along the wavelength dimension? The answer to this question is important for both practical and theoretical reasons because the number of samples can be quite large. For example, to sample the visible spectrum from 400 nm to 700 nm in 1 nm steps, we need about 300 measurements. To sample in 10 nm steps, we need about 30 measurements.

The answer to this sampling question depends on the same set of issues as the sampling questions we addressed in [Chapter 3](/chapter-3-the-photoreceptor-mosaic/) on the spatial sampling of the retinal image by the photoreceptor mosaics. If the energy in the light varies rapidly as a function of wavelength, then we may have to sample quite finely to measure accurately; if the functions vary slowly, then only a few measurements are necessary. Also, the precision of the representation requires that we know how sensitive the photopigments in the are to rapid changes in the energy as a function of wavelength.

![The spectral power distribution of two important light sources are shown: blue skylight (a) and the yellow disk of the sun (b).](/wp-content/uploads/2012/02/spectra1){#fig-spectra1 width="60%" .align-right}

It is difficult to make accurate generalizations about how spectral power distributions vary as a function of wavelength, but it is believed widely that for practical purposes we can approximate spectral power distributions using smooth, regular functions as shown in Figure~??. Also, it is known that the photopigments integrate broadly across the wavelength spectrum. Consequently, international standards organizations suggest making measurements every 5 nm to achieve an excellent representation of the signal. Practical measurements often rely on measurements spaced every 10 or 20 nm. We will consider this issue much more completely when we review color appearance, in [Chapter 9](/chapter-9-color/).

<a name="ScotopicWavelengthEncoding"></a>

## Scotopic Wavelength Encoding

What information do we encode about the spectral power distribution when rods initiate vision, under *scotopic* conditions? We can answer this question by an experiment designed to measure how well people can discriminate different spectral power distributions. In the *scotopic matching* experiment, we present an observer with two lights, side by side in a *bipartite* field. One side of the field contains the *test* light; it may have any spectral power distribution whatsoever. The second side of the field contains the *primary* light; it has a fixed relative spectral power distribution and can vary only by an overall intensity factor. The observer’s task in the *scotopic matching experiment* is to adjust the primary light intensity so that the primary light appears indistinguishable from the test light. The observer can adjust only the intensity of the primary light, so when the match is achieved the spectral power distributions of the test and primary lights that match are still different.

Under scotopic conditions, observers can adjust the primary intensity so that the primary matches any test light. Since subjects can always make this match, we have a simple answer to our question: The rods encode nothing about the relative spectral density of a light. An observer can adjust the intensity of a primary light to match the appearance of a test light with any spectral power distribution. The relative spectral power distribution is immaterial, all that matters is the relative intensities of the two lights.

### Matching: Homogeneity and superposition

We can learn more about scotopic wavelength encoding by studying the quantitative properties of the matching experiment. To characterize the matching experiment completely, we must be able to predict how a subject will adjust the primary intensity to match any test light. We treat the experiment as a transformation by identifying the spectral power distribution of the test light as the input and the intensity of the primary light as the output. A quantitative description of the experiment tells us how to map the input to the output.

Naturally, we first ask whether we can characterize the matching experiment transformation using linear systems methods. Denote the spectral power distribution of the test and primary lights using the vectors $\mathbf{t}$ and $\mathbf{p}$ respectively. The $n_{\lambda}$ entries of these vectors describe the power at each of the $n_{\lambda}$ sample wavelengths. To test linearity, we evaluate whether the scotopic matching experiment satisfies the linear systems properties of homogeneity and superposition. We can evaluate these properties from the following experimental tests:

- (Homogeneity) If $\mathbf{t}$ matches $e \mathbf{p}$, will $a \mathbf{t}$ match $a (e \mathbf{p})$?
- (Superposition) If $\mathbf{t}$ matches $e \mathbf{p}'$, and ${\mathbf{t}'}$ matches ${e'} \mathbf{p}'$, will $\mathbf{t} + \mathbf{t}'$ match $( e \mathbf{p} ) + ( e' \mathbf{p} )$?

![Hypothetical scotopic matching experiment. The horizontal scale measures the intensity of a monochromatic test light and the vertical scale measures the intensity a matching 510 nm primary light. Since the scotopic matching experiment satisfies homogeneity, the data will fall along a straight line. The slope of the line defines the relative scotopic sensitivity to each test wavelength.](/wp-content/uploads/2012/02/scotopic.png ){#fig-scotopic width="60%" .alignright}

An hypothetical test of homogeneity is shown in Figure 4.5. The separate panels show the intensity of the test light on the horizontal axis and the intensity of the matching primary light on the vertical axis. Each panel plots the results using spectral test lights at a series of wavelengths and a 510 nm primary light. In the scotopic matching experiment the data will fall on a straight line, consistent with the prediction from homogeneity. The slope of the line defines the relative scotopic sensitivity to the test and the primary lights. For example, in panel (c) the hypothetical results from an experiment with a 580 nm test light are shown. The slope of the line shows that we need $8.3$ units of energy at 580 nm to have the same effect as one unit of energy at 510 nm. Hence, the light at 510 nm is $8.3$ times more effective, per unit energy, than the light at 580 nm.

Because the scotopic matching experiment is linear, there must be a system matrix, $\mathbf{R}$ that maps the input ($\mathbf{t}$, the test spectral power distribution), to the output ($e$, the primary light intensity). The system matrix, call it $\mathbf{R}$, must have one row and $n_{\lambda}$ columns. The test light, system matrix, and primary intensity are related by the product, $e = \mathbf{R} \mathbf{t}$.

![Matrix tableau of the scotopic matching experiment. The primary light intensity, e, equals the product of the scotopic matching system matrix and the test light spectral power distribution.](/wp-content/uploads/2012/02/Scotopic-Tableau-300x218.png ){#fig-scotopic-tableau width="60%" .alignright}

We can relate the measurements in the scotopic matching experiment to the entries of the system matrix as follows. Write the matrix product $\mathbf{R} \mathbf{t}$ as a summation over the sample wavelengths,

$$
e = \sum_{i=1}^{i=n_{\lambda}} R_{i} \mathbf{t}_{i}
$$ {#eq-scotopic-sum}

Suppose we use a monochromatic test light of unit intensity, that is, an input $\mathbf{t}$ that has only a single non-zero wavelength, $(0,0,...,0,1,0,...0)^{T}$. Then Equation~\@ref(eq-scotopic-sum) becomes simply $e = R_{i} \mathbf{t}_{i}$. This shows that the slope of the line relating the monochromatic test intensity, $\mathbf{t}_{i}$, to the primary intensity, $e$, is the system matrix entry, $R_{i}$. Hence, we can estimate the system matrix from the slopes of the experimental lines we measure in the test of homogeneity shown in Figure 4.5.

![The scotopic spectral sensitivity function defines the human wavelength sensitivity under scotopic viewing conditions. The curve is a plot of the entries of the scotopic system matrix.](/wp-content/uploads/2012/02/scot.sens_.png ){#fig-scotopic-sens width="60%" .alignright}

Figure 4.7 is a graphical method of representing the system matrix of the scotopic matching experiment. The curve shows the entries of $\mathbf{R}$ as a function of wavelength, interpolated from experimental measurements at many sample wavelengths. The curve is called the *scotopic sensitivity function*.

Once we measure the system matrix, $\mathbf{R}$, we can predict whether any pair of lights will match under scotopic conditions. Figure 4.6 shows how we use the system matrix to predict the intensity of a primary light needed to match a test light. Suppose we have two test lights, $\mathbf{t}$ and $\mathbf{t} '$. Two lights will match when they are matched by the same intensity of the primary light. So, these two lights will match when $\mathbf{R} \mathbf{t} = \mathbf{R} \mathbf{t} '$.

### Uniqueness

The hypothetical experiment illustrated in Figure 4.5 assumed a 510 nm primary light. Suppose that we perform the scotopic matching experiment using a different primary light. How will this effect the system matrix, $\mathbf{R}$?

We can answer this question by a thought experiment. Call the second primary light $\mathbf{p}'$. We can set a match between the new primary light, $\mathbf{p}'$, and the first primary light $\mathbf{p}$. We will find that there is some scalar, $k$, such that $k \mathbf{p}'$ matches $\mathbf{p}$, and we expect that whenever $a \mathbf{p}$ matches a test light, $\mathbf{t}$, then $a (k \mathbf{p}')$ will match $\mathbf{t}$. In particular, since $R_{i} \mathbf{p}$ matches the $i^{th}$ monochromatic test light, we expect that $R_{i} k \mathbf{p}'$ will match the $i^{th}$ monochromatic test light as well. It follows that the entries of the new system matrix will be $k R_{i}$, equal to the original except for a constant scale factor, $k$. Hence, the new system matrix will be $k \mathbf{R}$, and we say that the estimate of $\mathbf{R}$ is unique up to an unknown scale factor.

### The Biological Basis of Scotopic Matching

![The scotopic matching experiment is remarkable in its simplicity. We can understand the biological basis of the experimental matches by studying the properties of the rod photopigment, rhodopsin.](/wp-content/uploads/2012/02/Alligator.png ){#fig-alligator width="60%" .alignright}

Figure 4.8 is a photograph of the photopigment contained in the rod outer segments. In part (a) of the figure the photopigment is photographed in the eye of an alligator. Because the back of the alligator’s eye contains a white reflective surface, called the  *tapetum*, it is possible to see the color of the rod photopigment. Cats too have a white tapetum, which is why cats eyes appear to glow so brightly when they catch the beam of a car’s headlights. The alligator shown in the picture had been kept in a dark closet for 24 hours so that the photopigment would be fully regenerated and easy to photograph. The closet was opened briefly, a flash picture taken, and then I suppose the door was shut again. Whew. \nocite{RushtonAlligatorSciAm}

Rod photopigment is present in much higher density than any of the cone photopigments. Thus, researchers have been able to isolate and extract the rod photopigment for fifty years, whereas the cone photopigments have only become available recently through the methods of genetic engineering (Merbs and Nathans, 1992). Characteristically, when the rod photopigment is exposed to light, it undergoes a series of rapid changes in chemical state (Hubbard and Wald, 1951; Wald and Brown, 1956; Wald, 1968). Whenever a quantum of light is absorbed by the rhodopsin photopigment, it undergoes a specific sequence of events resulting in the decomposition of the rhodopsin molecule into opsin and vitamin A. Figure~??b shows the same alligator after its eye has been exposed to light. The rhodopsin is been broken into two parts and the resulting products are clear, rather than purple. In this state, the white tapetum of the eye is evident. It is the wavelength selectivity of the rhodopsin photopigment that provides the biological basis of scotopic matching. The relationship between the behavioral experiment and the properties of the rod photopigment is based on an important property called *univariance*.

W. Rushton emphasized that when a photopigment molecule absorbs light, the effect upon the photopigment is the same no matter what the wavelength of the absorbed light might be. Thus, even though quanta at 400 nm possess more energy than quanta at 700 nm, the sequence of rhodopsin reactions to absorption of a 400 nm quantum is the same as the sequence of reactions to a 700 nm quantum. Rushton used the word *univariance* for this principle to remind us that a single photopigment makes only a single-variable response to the incoming light. The photopigment maps all spectral lights into a single-variable output, the *rate of absorptions*. The response of a single photopigment does not encode any information about the relative spectral composition of the light. This explains why we cannot discriminate between lights with different spectral power distributions under scotopic viewing conditions (Rushton, 1965; Naka and Rushton, 1966).

![An apparatus to measure the spectral absorption of a photopigment. Using the monochromator, one can select light at one wavelength from the light source. To estimate the fraction of photons absorbed by the photopigment at that wavelength, we divide the number of photons detected through the glass and photopigment by the number detected after passing through the glass alone.](/wp-content/uploads/2012/02/self.screening1.png ){#fig-self-screening width="60%" .alignright}

Univariance does not mean, however, that the photopigment responds equally well to all spectral lights. The photopigment is much more likely to absorb some wavelengths of light than others. Univariance asserts that once absorbed, however, all quanta have same visual effect.

We can measure the probability of absorption using the experimental apparatus shown in Figure 4.7. We place a thin layer of photopigment on a clear plate of glass. We create a monochromatic light by passing the light from an ordinary source through a *monochromator*. The monochromator can be constructed using prisms or diffraction gratings to separate the incident light into its separate wavelengths, much as in Newton’s original experiments. We measure the amount of monochromatic light passed through the photopigment and the glass plate by means of a photodetector at the rear of the apparatus. We then move the glass plate upwards, to remove the photopigment from the light path, and measure again. The difference in the photodetector signal measured in these two conditions is proportional to the amount of light absorbed by the photopigment.

![Rhodopsin absorptions at different wavelengths. The number of absorptions in a thin layer of photopigment are proportional to the intensity of the input light and thus satisfy the principle of homogeneity. The slope of the linear relationship between the light intensity and the number of absorptions describes the fraction of photon absorptions. The slope varies with the wavelength of the test light, thus defining the photopigment wavelength sensitivity.](/wp-content/uploads/2012/02/scotopic1.png){#fig-scotopic1 width="60%" .aligncenter}
If only a thin layer of photopigment is present, the experimental measurements of the absorptions will satisfy homogeneity and superposition. To test homogeneity, we increase the intensity of the test light. We will find that the number of absorptions will increase proportionately over a significant range. To test superposition, we measure the photopigment absorptions to a test light $\mathbf{t}$ to be $a$, and the number of absorptions to a second light $\mathbf{t}'$ to be $a'$. When we superimpose the two input lights, we will measure $a + a'$ absorptions. Since the measurement process is linear, we can estimate the system matrix of this absorption process, $\mathbf{A}$, just as we measured the system matrix of the scotopic matching experiment, $\mathbf{R}$.

![Comparisons of scotopic matching and rhodopsin wavelength sensitivity. The filled circles show human rhodopsin absorption measured as in Figure 4.7. The open circles show human scotopic sensitivity, corrected for light loss at the lens and optical media. (Source: Wald and Brown, 1958)](/wp-content/uploads/2012/02/rhodopsin.sens_.png){#fig-rhodopsin-sens width="60%" .alignright}

We can predict the matches in the scotopic matching experiment from the absorptions of the rhodopsin photopigment. A test and primary light match in the scotopic matching experiment when the two lights create the same number of absorptions in the rhodopsin photopigment. We can demonstrate this by comparing the system matrices of the scotopic matching experiment and the rhodopsin absorption experiment. After we correct for the effects of the wavelength sensitive elements of the eye, mainly the lens, we can plot the system matrices of the scotopic matching experiment $\mathbf{R}$, and the rhodopsin absorption experiment, $\mathbf{A}$, on the same graph. Wald and Brown (1958) made this comparison in the graph shown in Figure 4.9. The filled circles in the graph plot the measurements of the system matrix from the rhodopsin absorption experiment, $\mathbf{A}$. The completely open circles plot estimates of the entries of $\mathbf{R}$ after correcting for the fact that the lens absorbs a significant amount of light in the short-wavelength part of the spectrum.

The agreement between the measurements of the rhodopsin photopigment and the scotopic matching experiment confirm a simple model of the observer’s behavior. Under scotopic viewing conditions the observer’s perception of the two halves of the bipartite field depends on a signal initiated by the rod photopigment absorptions. The two sides of the field appear identical when the rhodopsin absorption rates on the two sides of the bipartite field are equal. During the experiment, then, the observer adjusts the intensity of the matching light to equalize the rod absorption rates on the two sides of the bipartite field. Since the absorption of the light is a linear process, the observer’s behavior is linear, too.

The precise quantitative match between the scotopic matches and the rod photopigment make a very strong connection between performance and biological encoding of the light. This type of precise quantitative relationship between behavior and the biological encoding of light serves as a good standard to use when we consider the relationship between behavior and biology in other conditions.

## Photopic Wavelength Encoding

When the cones initiate vision, under photopic conditions, we do encode some information about the relative spectral power distribution of the incident light. Changes in the relative spectral power distributions result in changes of the color appearance of the light. Several of the important properties of color appearance can be traced to the way cone photoreceptors encode the relative spectral power distribution of light\footnote{ N.B. Color appearance is not a simple consequence of the spectral power distribution of the incident light. We will discuss color appearance broadly in [Chapter 9](/chapter-9-color/)}.

![The color-matching experiment. The observer views a bipartite field and adjusts the intensities of the three primary lights to match the appearance of the test light. (a) A side-view of the experimental apparatus. (b) The appearance of the stimuli to the observer. (After Judd and Wyszecki, 1975.)](/wp-content/uploads/2012/02/colorMatching.png ){#fig-color-matching width="60%" .aligncenter}

We will relate the human ability to discriminate lights to the properties of the cones just as we did with the rods. First, we will review the matching experiments that characterize how well people can discriminate between lights with spectral power distributions. When we measure under photopic conditions, the experiment is called the  *color-matching* experiment. The color-matching experiment is the foundation of color science and of direct significance to many color applications (see the Appendix). Second, we will relate the properties of the color-matching experiment to the properties of the cone photopigments. The analysis of photopic wavelength encoding parallels the analysis of scotopic wavelength encoding. The main differences are that (a) we must keep track of the photopigment absorptions in three cone photopigments rather than the single rod photopigment, and (b) until quite recently the cone photopigments were not present in sufficient quantity to define their properties with any certainty (Merbs and Nathans, 1992). Hence, the problem of relating color-matching and the cone photopigments was solved using other indirect biological measurements. We can learn a great deal from studying the logic of these methods.

Figure 4.10 shows a simple apparatus that can be used to perform the color-matching experiment. The observer views a bipartite visual field with the test light on one side. The test light may have any spectral power distribution. The second half of the bipartite field contains a mixture of  *three* primary lights. Throughout the experiment, the relative spectral power distribution of each primary light is constant; only the absolute level of the primary lights can be adjusted. The observer’s task is to adjust the intensities of the three primary lights so that the two sides of the bipartite field appear identical.

![Metameric lights. Two lights with these spectral power distributions appear identical to most observers and are called metamers. The curve in part (a) is an approximation to the spectral power distribution of the sun. The curve in part (b) is the spectral power distribution of a light emitted from a conventional television monitor whose three phosphor intensities were set to match the light in (a) in appearance.](/wp-content/uploads/2012/02/tvMetamers.png ){#fig-tv-metamers width="60%" .alignright}

When the observer has completed setting an appearance match, the lights on the two sides of the bipartite field are not physically the same. The test light can have any spectral power distribution, while the mixture of primaries can only have a limited number of spectral power distributions determined by the possible weighted sums of the three primary light spectral power distributions. Lights that are photopic appearance matches, but that are physically different, are called  *metamers*. Figure 4.11 contains a pair of spectral power distributions that match visually but differ physically, i.e. a pair of metamers.

The metamers in Figure 4.11 illustrate that even under photopic viewing conditions we fail to discriminate between very different spectral power distributions. To understand the behavioral aspects of photopic wavelength encoding, we must try to predict which spectral power distributions we can discriminate. The first question we ask is whether we can predict performance in the photopic color-matching experiment using linear systems methods.

![The color-matching experiment satisfies the principle of superposition. In parts (a) and (b) test lights are matched by a mixture of three primary lights. In part (c) the sum of the test lights is matched by the additive mixture of the primaries, demonstrating superposition.](/wp-content/uploads/2012/02/phot.superposition.png ){#fig-phot-superposition width="60%" .aligncenter}

We can define the experimental measurements in the color-matching experiment in direct analogy with the definitions we used in the scotopic matching experiment. The input variable in the color-matching experiment is the light $\mathbf{t}$, just as in scotopic matching. In the color-matching experiment, however, the subject’s responses consist of three numbers, not just one. So, we record the responses using a three-dimensional vector, $\mathbf{e}$. The entries of $\mathbf{e}$ are the intensities of the three primary lights $( e{1} , e{2} , e{3} )$. To test superposition in the color-matching experiment we follow the logic illustrated in Figure 4.12. We obtain a match to a $\mathbf{t}$ by adjusting the primary intensities to the levels in $\mathbf{e}$. We then obtain a match to $\mathbf{t} '$ by adjusting the three primary intensities to $\mathbf{e} '$. We test additivity by verifying that the match to $\mathbf{t} + \mathbf{t} '$; is $\mathbf{e} + { \mathbf{e} '}$.
Photopic color-matching satisfies homogeneity and superposition. We honor the person who first understood the importance of superposition in color-matching by calling this empirical property  *Grassmann’s additivity law*.

![Matrix tableau of color-matching. The photopic color-matching experiment defines a linear mapping from the test light spectral power distribution to the intensity of the three primary lights. The rows of the system matrix are called the color-matching functions. These functions can be estimated by setting matches to many different test lights and solving a set of linear equations.](/wp-content/uploads/2012/02/photopic.png ){#fig-photopic width="60%" .alignright}

Because the color-matching experiment linearly maps the physical stimulus $\mathbf{t}$ to the primary intensities, $\mathbf{e}$, there must be a system matrix that maps the input vector $\mathbf{t}$ to the output vector $\mathbf{e}$. Figure 4.15 shows the input-output relationship for the photopic color-matching experiment in matrix tableau. We will call the $3 \times n_{\lambda}$ system matrix $\mathbf{C}$.

We can estimate the system matrix $\mathbf{C}$ from the color-matches in the same way as we estimated the scotopic system matrix: by setting matches to a collection of monochromatic test lights with unit intensity. Since the vector representing a monochromatic test light is zero at each entry but one, the product of the system matrix and the monochromatic test light vector equals a single column of the system matrix. Thus, by matching a series of unit intensity monochromatic lights, we can define each of the columns of the system matrix, $\mathbf{C}$.

It is also useful to think of the system matrix in terms of its rows, which are called the  *color-matching functions*. Each row of the matrix defines the intensity of a single primary light that was set to match the monochromatic test lights. We will relate the rows of the photopic system matrix to the properties of the cone photopigments just as we related the single row of the scotopic system matrix to the rhodopsin photopigment. However, to make the connection between the cone photopigments and the color-matching functions will require a little more work.

### Measurements of the Color-Matching Functions
Two important caveats arise when we measure the color-matching functions. These are only a minor theoretical nuisance, but they have important implications for the laboratory experiment and for practical applications.

The first issue concerns the selection primary lights. We should chose lights that are visually  *independent*: that is, no additive mixture of two of the primary lights should be a visual match to the third primary. This is an obvious but important constraint: it would be unreasonable to choose the second primary light that looked the same as the first except for an intensity scale factor. This choice would be foolish since we could always replace the second light by an intensity-scaled version of the first primary light, adding nothing to the range of visual matches we can obtain. Similarly, a primary that can be matched by a mixture of the first two adds nothing. We must choose our primary lights so that they are independent of one another.

Even among collections of primary lights that are independent, some are more convenient than others. Empirically, it turns out that no matter which primary lights we choose, there will always be some test lights that cannot be matched by an additive mixture of the three primaries. To match these test lights, we must move one or even two of the primary lights from the matching side of the bipartite field to the test side of the bipartite field. Thus, ordinarily we obtain a visual matches of the form
$$
\mathbf{t} = e_1 \mathbf{p}_1 + e_2 \mathbf{p}_2 + e_3 \mathbf{p}_3 .
$${#eq-cmatch1}

Shifting one of the primaries to the other side of the bipartite field means that our match has the form

$$
\mathbf{t} + e_1 \mathbf{p}_1 = e_2 \mathbf{p}_2 + e_3 \mathbf{p}_3 .
$$ {#eq-cmatch2}

To a mathematician, Equation (3) is the same as

$$
\mathbf{t} = - e_1 \mathbf{p}_1 + e_2 \mathbf{p}_2 + e_3 \mathbf{p}_3 .
$${#eq-cmatch3}

Hence, when we encode the intensity of the primary light that has been shifted to the other side of the test field we denote the match using a negative intensity value\footnote{ Changing the sign of the primary intensity is a trivial matter for the theorist. It is a nuisance in the laboratory, however, and usually impossible in technological applications such as color displays. Thus, the issue of selecting primaries to minimize the number of times we must make this adjustment is of great practical interest.}.

![The color-matching functions are the rows of the color-matching system matrix. The functions measured by Stiles and Burch (1959) using a 10 deg bipartite field and primary lights at the wavelengths 645.2 nm, 526.3 nm, and 444.4 nm with unit radiant power are shown.](/wp-content/uploads/2012/02/cie.rgb_.png ){#fig-cie-rgb width="60%" .alignright}

Figure 4.3 plots color-matching functions measured by Stiles and Burch (1959) using three monochromatic primary lights at 645.2 nm, 525.3 nm and 444.4 nm. Each function describes the intensity of one of the primary lights used to match various monochromatic test lights. Notice that the intensity of the red primary, at 645.2 nm nm, is negative over a region of test light wavelengths, indicating that over this range of test lights the 645.2 nm primary light was added to the test field.

The color-matching functions are extremely important in color technology, such as creating images on color monitors and color printers. I review the application of these methods to color monitors in the Appendix.

### Uniqueness of the Color-Matching Functions

Suppose two research groups measure the color-matching functions using different sets of primary lights. One group measures the color-matching functions using three primary lights $\mathbf{p}_{i}$, while the second group uses a different set of primary lights, $\mathbf{p}_{i}'$. How will the two sets of color matching functions be related?

We can answer this question by the following thought experiment. First, create a matrix whose columns contain the spectral power distributions of the first group’s primary lights, and call this matrix $\mathbf{P}$. The spectral power distribution of a mixture of the primaries, with primary intensities $\mathbf{e}$, is the weighted sum of the columns. We can express this mixture using the matrix product $\mathbf{P} \mathbf{e}$. Now, we can use the color-matching functions to predict when a test light will match the mixture of three primaries. The test and primaries will match when

<a name="id193940126"></a>

$$
\mathbf{C} \mathbf{t} = \mathbf{C} \mathbf{P} \mathbf{e}
$$

Suppose the second group of researchers can also established matches to this test light using their primaries. To describe their measurements, we create a second matrix whose columns contain the spectral power distributions of the second group’s primary lights, $\mathbf{P}'$. Call the primary intensities used to match the test with the second primaries $\mathbf{e}'$. Since the light $\mathbf{P}' \mathbf{e}'$ is a visual matched to the test light, we know that

$$
\mathbf{C} \mathbf{t} = \mathbf{C} \mathbf{P}' \mathbf{e}'
$$ {#eq-photopic-match2}

By combining Equations~\@ref(eq-photopic-match) and \@ref(eq-photopic-match2), we find that the two vectors of primary intensities, $\mathbf{e}$ and $\mathbf{e}'$, are related by a linear transformation,

$$
\mathbf{e} = (\mathbf{C} \mathbf{P} )^{-1}\mathbf{C} \mathbf{P}' \mathbf{e}'
$$ {#eq-photopic-transform}

With a little more algebra, one can show that the color-matching functions are related by the following linear transformation:

$$
\mathbf{C} = ( \mathbf{C} \mathbf{P}') \mathbf{C}'
$$ {#eq-photopic-transform2}

...

When we set a match between the peak photocurrent from the test light and the primary light, we establish an equation of the form

$$
F( \mathbf{A} \mathbf{t}) = F( a \mathbf{A} \mathbf{p} )
$$ {#eq-static-nonlinearity}

where $a$ is the intensity of the primary light needed to match the test light. Since the nonlinear function $F$ is monotonic, we can remove it from both sides of the Equation and write

$$
\mathbf{A} \mathbf{t} = a \mathbf{A} \mathbf{p}
$$ {#eq-static-nonlinearity-linear}

...

We predict that two lights $\mathbf{t}$ and $\mathbf{t}'$ will be a visual match when they have equivalent effects on the cone photopigments. Thus, two lights will be metamers when

$$
\mathbf{B} \mathbf{t} = \mathbf{B} \mathbf{t}'
$$ {#eq-cone-metamers}

It follows that the cone absorption matrix $\mathbf{B}$ is a system matrix for the color-matching experiment. This is precisely what we mean when we say that the cone photopigments can explain the color-matching experiment. Earlier in this chapter, we showed that the color-matching functions are all related by a $3 \times 3$ linear transformation. Thus, there should be a linear transformation, say $\mathbf{Q}$, that maps the cone absorption curves to the system matrix of the color-matching experiment, namely

$$
\mathbf{C} = \mathbf{Q} \mathbf{B}
$$ {#eq-cone-to-photopic}
